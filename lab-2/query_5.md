Query
-
```postgresql
WITH G AS (
	SELECT Н_ОБУЧЕНИЯ.НЗК, CONCAT (Н_ЛЮДИ.ФАМИЛИЯ, ' ', Н_ЛЮДИ.ИМЯ, ' ', Н_ЛЮДИ.ОТЧЕСТВО) AS ФИО, ВЕД.ЧЛВК_ИД, ВЕД.ОЦЕНКА, Н_УЧЕНИКИ.ГРУППА FROM (
		SELECT ЧЛВК_ИД, AVG(ОЦЕНКА) AS ОЦЕНКА FROM (
			SELECT ЧЛВК_ИД, (ОЦЕНКА::int) AS ОЦЕНКА FROM Н_ВЕДОМОСТИ 
			WHERE ОЦЕНКА NOT IN ('осв', 'неявка', 'незач', 'зачет', '99')
		) AS ВЕД GROUP BY (ЧЛВК_ИД)
	) AS ВЕД
	JOIN Н_УЧЕНИКИ ON Н_УЧЕНИКИ.ЧЛВК_ИД = ВЕД.ЧЛВК_ИД
	JOIN Н_ОБУЧЕНИЯ ON Н_ОБУЧЕНИЯ.ЧЛВК_ИД = ВЕД.ЧЛВК_ИД
	JOIN Н_ЛЮДИ ON Н_ЛЮДИ.ИД = ВЕД.ЧЛВК_ИД
)
SELECT НЗК, ФИО, ОЦЕНКА FROM G
WHERE ГРУППА = '4100' 
  AND ОЦЕНКА <= (
	SELECT AVG(ОЦЕНКА) FROM G 
	WHERE ГРУППА = '1101'
  );
```